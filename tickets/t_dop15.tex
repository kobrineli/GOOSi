\textbf{\LARGE dop 14. Основные  понятия  криптографии.  Односторонняя  функция  с  секретом.  Протокол  Диффи-Хеллмана выработкиобщего секретного ключа по открытому каналу связи.}

\textbf{Криптография} --- наука о способах преобразования (шифрования) информации с целью её защиты от незаконных пользователей, обеспечения целостности и реализации методов проверки подлинности.

\textbf{Открытый текст} --- сообщение, подлежащее шифрованию.

\textbf{Шифротекст} (криптограмма) --- результат шифрования открытого текста.

\textbf{Шифр} --- семейство обратимых отображений множества последовательностей открытых текстов во множество последовательностей шифротекстов.

\textbf{Ключ} --- параметр, определяющий выбор конкретного отображения.

\textbf{Зашифрование} --- процесс преобразования открытого текста в шифрованный с помощью шифра и ключа к данному тексту.

\textbf{Расшифрование} --- процесс, обратный к зашифрованию, реализуемый при известном значении ключа.

\textbf{Дешифрование} --- процесс раскрытия криптограммы без знания секретного ключа.

\textbf{Односторонняя функция} --- обратимая функция: $X \rightarrow Y$, обладающая свойствами:
\begin{enumerate}
    \item $\exists$ полиномиальный алгоритм вычисления значений $f(x)$.
    \item $\nexists$ полиномиального алгоритма обращения функции $f$.
\end{enumerate}

\textbf{Односторонняя функция с секретом} (с лазейкой) — функция $f_k(x): X \rightarrow Y$ зависящая от параметра $k$, называемым секретным ключом или лазейкой и такая, что:
\begin{enumerate}
    \item Вычисление значения $f_k(x)$ относительно несложно и при этом не требуется значение параметра $k$.
    \item Вычисление значения $f^{-1}_k(y)$ для всех $y \in Y$ при известном $k$ относительно несложно.
    \item Почти для всех $k$ и $y \in Y$, нахождение $f^{-1}_k(y)$ вычислительно неосуществимо без знания $k$.
\end{enumerate}

\textbf{Один из примеров}, претендующих на то, чтобы являться односторонней функцией с лазейкой --- функция $f(x) = x^m (\text{mod } n)$, $n$ и $m$ известны. 
Вычисление $f(x) = y$ производится методом быстрого возведения в степень, а эффективный алгоритм обратного преобразования $f^{-1}(y)$, то есть вычисление корня m-ой степени по mod n, требует примарного разложения $n$ [типо разложение на простые числа]. 
Эта информация может считаться лазейкой.

\textbf{Простые поля Галуа} -- поля классов вычетов по модулю простого числа. Пример: $Z_3 = \{n (mod  3)\} = \{0, 1, 2\}$

Порождающие элементы мультипликативной группы поля [м.г. -- типо все элементы поля без нуля] называют его \textbf{примитивными элементами}.

\textbf{Пример}: числа 2, 6, 7, 8 -- примитивные элементы поля $\mathbb{F}_{11}$

Проверяем 2:

\begin{tabular}{c|c c c c c c c c c c}
    \hline
     $k$           & 1 & 2 & 3 & 4 & 5  & 6 & 7 & 8 & 9 & 10 \\
    \hline
     $2^k (mod 11)$ & 2 & 4 & 8 & 5 & 10 & 9 & 7 & 3 & 6 & 1 \\
    \hline
\end{tabular}

$ord(2) = 10 \implies$ 2 -- примитивный. Проверим, например, 3:

\begin{tabular}{c|c c c c c}
    \hline
     $k$            & 1 & 2 & 3 & 4 & 5 \\
    \hline
     $3^k (mod 11)$ & 3 & 9 & 5 & 4 & 1 \\
    \hline
\end{tabular}

$ord(3) = 5 \neq 10 \implies$ 3 -- не примитивный.

Как ускорить проверку примитивности:

$p = 11, p-1=2 \cdot 5$, проверяем степени $\frac{10}{2} = 5$ и $\frac{10}{5} = 2$ элементов 2 и 3:

$2^2(mod 11) = 4 \neq 1, 2^5(mod 11) = 10 \neq 1 \implies$ 2 -- примитивный.

$3^2(mod 11) = 9 \neq 1, 3^5(mod 11) = 1 \implies$ 3 -- не примитивный.

\textbf{Выработка общего секретного ключа по открытому каналу связи (протокол Диффи-Хеллмана)}

Алиса (А) и Боб (В) обмениваются сообщениями по открытому каналу. 
Для обеспечения секретности нужен общий секретный ключ. 
\begin{enumerate}
    \item A и B выбирают простое число $p$ (число p нужно выбирать очень большим, чтобы было очень сложно "взломать" подбором - аналитически не решается) и в (простом) поле Галуа $GF(p)$ некоторый примитивный элемент $\alpha$.
    Данные значения не являются секретом. 
    \item A и B независимо друг от друга выбирают по одному случайному натуральному числу $x$ и $y$ соответственно, которые держат в секрете. 
    \item Далее они вычисляют, соответственно, $X = \alpha^x (\text{mod } p),~Y = \alpha^y (\text{mod } p)$.
    $X$ и $Y$ передаются друг другу по открытому каналу.
    \item A вычисляет: $K = Y^x (\text{mod } p)$.
    B вычисляет: $K = X^y (\text{mod } p)$.
    \item Таким образом, A и B получают общий секретный ключ $K = \alpha^{xy} (\text{mod } p)$, который в дальнейшем используется в алгоритмах симметричного шифрования.  
\end{enumerate}

Пассивный злоумышленник, перехвативший, но не изменяющий сообщений не может определить ключ $K$: его определение связано с решением одного из ур-ей шага 3, а это вычислительно трудная задача дискретного логарифмирования.

Протокол Диффи-Хеллмана подвержен атаке \textbf{"человек по середине"}: если к каналу связи имеет доступ активный злоумышленник, то выработав два ключа -- общий с A и общий с B, он может представляться Алисе Бобом, а Бобу -- Алисой.

% -------- source --------
\bigbreak
[\cite[page 139-151]{gurov}]